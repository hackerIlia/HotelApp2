@page "/User"
@using Microsoft.AspNetCore.Components.QuickGrid
@inject HotelApp2.Models.Hotel_DBContext DB
@using HotelApp2.Models
@using Microsoft.EntityFrameworkCore

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />

<PageTitle>Index</PageTitle>

<h1>Users</h1>

<p>
    <a href="User/create" style="font-size:20px"><i class="fas fa-plus"> Create new</i></a>
</p>

@if (users != null)
{
    <QuickGrid Class="table" Items="DB.HUsers">
        <PropertyColumn Property="huser => huser.Login" />
        <PropertyColumn Property="huser => huser.Password" />
        <PropertyColumn Property="huser => huser.FirstName" Title="First Name" />
        <PropertyColumn Property="huser => huser.LastName" Title="Last Name" />
        <PropertyColumn Property="huser => huser.Email" />
        <PropertyColumn Property="huser => huser.Staff.FirstName + ' ' + huser.Staff.LastName" Title="Staff" />

        <TemplateColumn Context="huser">
            <a href="@($"User/edit?id={huser.Id}")"><i class="fas fa-edit"> Edit </i></a> |
            <a href="@($"User/delete?id={huser.Id}")"><i class="fas fa-trash-alt"> Delete</i></a>
        </TemplateColumn>
    </QuickGrid>
}
else
{
    <p>No records found</p>
}


@code{
    List<HUser> users;

    protected override async Task OnInitializedAsync()
    {
        users = await DB.HUsers.Include(u => u.Staff).ToListAsync();
    }
}